@startuml SGC

title Système de Gestion de Caisse (SGC) - Architecture de Déploiement (API REST avec NGINX et N instances API)

node "Maison Mère (Serveur Central)" {

  node "Proxy NGINX" {
    component "Serveur NGINX" <<proxy>>
  }

  node "Instance API N" {
    component "Interface API REST" <<REST>>
    component "REST Controller Layer" <<controller>>
    component "CaisseService"
    component "MaisonMereService"
    component "StockService"
    component "VenteService"
    component "DemandeApprovisionnementService"
    component "TransactionManager"
    component "LoggingService" <<library>>
    component "ProduitRepository"
    component "VenteRepository"
    component "DemandeApprovisionnementRepository"
    component "Pool de Connexions" <<connector>>
  }

  node "Serveur Base de Données" {
    database "Base de données PostgreSQL" as DB
  }
}

node "Poste de travail N" {
  node "Interface Caisse N" {
    component "Client Console" <<HTTP client>>
  }
}

node "Poste Maison Mère" {
  node "Interface" {
    component "Interface Web Maison Mère" <<HTTP client>>
  }
}

"Client Console" --> "Serveur NGINX" : HTTP/JSON
"Interface Web Maison Mère" --> "Serveur NGINX" : HTTP/JSON

"Serveur NGINX" --> "Interface API REST" : proxy_pass

"Interface API REST" --> "REST Controller Layer"
"REST Controller Layer" --> "CaisseService"
"REST Controller Layer" --> "MaisonMereService"
"REST Controller Layer" --> "StockService"
"REST Controller Layer" --> "VenteService"
"REST Controller Layer" --> "DemandeApprovisionnementService"

"CaisseService" --> "StockService"
"CaisseService" --> "VenteService"
"CaisseService" --> "DemandeApprovisionnementService"
"CaisseService" --> "TransactionManager"
"CaisseService" --> "LoggingService"

"MaisonMereService" --> "StockService"
"MaisonMereService" --> "VenteService"
"MaisonMereService" --> "DemandeApprovisionnementService"
"MaisonMereService" --> "LoggingService"

"StockService" --> "ProduitRepository"
"StockService" --> "DemandeApprovisionnementRepository"
"VenteService" --> "VenteRepository"
"DemandeApprovisionnementService" --> "DemandeApprovisionnementRepository"

"ProduitRepository" --> "Pool de Connexions"
"VenteRepository" --> "Pool de Connexions"
"DemandeApprovisionnementRepository" --> "Pool de Connexions"
"Pool de Connexions" --> DB

@enduml
